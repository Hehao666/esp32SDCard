<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes" />
  <link rel="stylesheet" href="../系统/CSS/fontawesome-free-6.5.2-web/css/all.min.css">
  <link rel="stylesheet" href="../系统/css.css" />
  <title>网页游戏</title>
</head>
<style>
  body {
    font-family: Arial, sans-serif;
    /* 更换默认字体 */
    line-height: 1.6;
    /* 提升文本行间距 */
  }

  .nav-item {
    font-weight: bold;
    /* 导航文字加粗 */
  }

  .container {
    width: 300px;
    margin: 10px auto 0 350px;
  }

  .right-content {
    width: 300px;
    /* 设置右侧内容的宽度 */
    overflow-y: auto;
    margin: 10px auto 0 150px;
  }

  .right-content a {
    display: inline-flex;
    /* 使链接内的元素水平排列 */
    align-items: center;
    /* 确保文本垂直居中 */
    gap: 5px;
    /* 在游戏名和大小之间添加间距 */
    white-space: nowrap;
  }

  /* 新增样式 */
  .container p {
    margin: 16px 0;
    /* 上下外边距16px，左右默认 */
    line-height: 1.5;
    /* 行高调整，让文字更加易读 */
  }

  .container a {
    color: #007bff;
    /* 链接颜色 */
    text-decoration: none;
    /* 去除下划线 */
    transition: color 0.3s ease;
    /* 颜色过渡效果 */
  }

  .container a:hover {
    color: #0056b3;
    /* 鼠标悬停时的颜色 */
  }

  /* 可选：为每个游戏链接添加图标样式 */
  .container a:before {
    font-family: "Font Awesome\ 6 Free", sans-serif;
    content: "\f111";
    /* 选择一个合适的图标，这里仅为示例 */
    margin-right: 8px;
    /* 图标与文字间的间距 */
    font-weight: 900;
    /* 确保图标显示正常，根据Font Awesome版本可能需要调整 */
  }

  .game-list-container {
    height: 750px;
    /* 如果需要滚动条，保持这个设置 */
    overflow-y: auto;
    margin-top: 20px;
  }

  .game-list-container p {
    margin: 16px 0;
    line-height: 1.5;
  }

  .game-list-container a {
    color: #007bff;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .game-list-container a:hover {
    color: #0056b3;
  }

  .game-list-container a:before {
    font-family: "Font Awesome\ 6 Free", sans-serif;
    content: "\f111";
    margin-right: 8px;
    font-weight: 900;
  }

  /* 添加到您的CSS样式中 */
  .game-list-container::-webkit-scrollbar {
    width: 12px;
    /* 调整滚动条的宽度 */
  }

  .game-list-container::-webkit-scrollbar-track {
    background-color: rgba(0, 0, 0, 0, 0.1);
    /* 滚动条轨道的颜色 */
  }

  .game-list-container::-webkit-scrollbar-thumb {
    background-color: #888;
    /* 滚动条拇指的颜色 */
    border-radius: 6px;
    /* 滚动条拇指的圆角 */
  }

  .game-list-container::-webkit-scrollbar-thumb:hover {
    background-color: #555;
    /* 鼠标悬停时滚动条拇指的颜色 */
  }

  .game-and-right-wrap {
    display: flex;
    /* 启用Flexbox布局 */
    flex-direction: row;
    /* 默认横向布局 */
  }

  .right-content {
    /* 移除之前的位置固定，以便Flexbox控制其高度 */
    position: static;
    /* 根据需要调整宽度，以匹配设计 */
    width: 300px;
  }

  .game-and-right-container {
    display: flex;
    /* 使用 Flexbox 布局 */
    flex-wrap: nowrap;
    /* 不换行 */
  }

  .right-content::-webkit-scrollbar {
    width: 12px;
    /* 调整滚动条宽度与左侧一致 */
    /* 其他滚动条样式可参考左侧游戏列表的定义 */
  }

  .sticky-header {
    position: -webkit-sticky;
    /* 为旧版Safari兼容 */
    position: sticky;
    top: -60px;
    /* 这个值应根据实际情况调整，确保标题在滚动到适当位置时开始固定 */
    z-index: 1;
    /* 可选，确保标题位于其他内容之上 */
  }

  /* 隐藏滚动条但保持滚动功能 */
  .game-list-container,
  .right-content {
    scrollbar-width: none;
    /* 针对Firefox */
    -ms-overflow-style: none;
    /* 针对IE 和 Edge */
  }

  /* 隐藏Webkit内核浏览器（如Chrome, Safari等）的滚动条 */
  .game-list-container::-webkit-scrollbar,
  .right-content::-webkit-scrollbar {
    display: none;
  }

  .game-size {
    font-size: 0.9em;
    color: #666;
    margin-left: 5px;
    /* 或其他适当的间距，确保与游戏名称有清晰分隔 */
    display: inline;
    /* 确保game-size总是作为内联元素显示 */
  }

  .game-list-container p,
  .right-content p {
    background-color: #f9f9f9;
    /* 轻微背景色 */
    border-bottom: 1px solid #ddd;
    /* 分割线 */
    padding: 10px;
  }
</style>

<body>
  <nav>
    <ul>
      <li>
        <a class="logo">
          <img src="../配置/头像.jpg" alt="" />
          <span class="nav-item">哈哈233的网盘</span>
        </a>
      </li>
      <li>
        <a href="../系统/wifi.html">
          <i class="fa-sharp fa-solid fa-wifi"></i>
          <span class="nav-item">网络配置</span>
        </a>
      </li>
      <li>
        <a href="../系统/upload.html">
          <i class="fa-sharp fa-solid fa-circle-up"></i>
          <span class="nav-item">文件快传</span>
        </a>
      </li>
      <li>
        <a href="../系统/audio.html">
          <i class="fa-sharp fa-solid fa-headphones"></i>
          <span class="nav-item">音乐播放</span>
        </a>
      </li>
      <li class="current-page">
        <a href="../系统/webgame.html">
          <i class="fa-sharp fa-solid fa-gamepad"></i>
          <span class="nav-item">网页游戏</span>
        </a>
      </li>
      <li>
        <a href="../系统/video.html">
          <i class="fa-sharp fa-solid fa-film"></i>
          <span class="nav-item">私人影院</span>
        </a>
      </li>
      <li>
        <a href="../系统/clipboard.html">
          <i class="fa-sharp fa-solid fa-clipboard"></i>
          <span class="nav-item">剪切板</span>
        </a>
      </li>
      <li>
        <a href="../系统/allFile.html">
          <i class="fa-sharp fa-solid fa-folder"></i>
          <span class="nav-item">文件总管理</span>
        </a>
      </li>
      <li>
        <a href="/wificonnect">
          <i class="fa-sharp fa-solid fa-gears"></i>
          <span class="nav-item">模式转换</span>
        </a>
      </li>
      <li>
        <a href="../系统/set.html">
          <i class="fa-sharp fa-solid fa-gear"></i>
          <span class="nav-item">设置</span>
        </a>
      </li>
      <li>
        <a href="">
          <i class="fa-sharp fa-solid fa-database"></i>
          <span class="nav-item" id="currentMemory"></span>
          <span class="nav-item" id="totalMemory"></span>
        </a>
        <div class="progress-bar" id="memory-progress">
        </div>
      </li>
    </ul>
  </nav>
  <div class="game-and-right-wrap">
    <div class="game-list-container">
      <div class="container">
        <H2 class="sticky-header">HTML</H2>
        <p><a href="../游戏/liferestart/public/index.html">人生重开模拟器</a></p>
        <p><a href="../游戏/bullseye-game/dist/index.html">射箭</a></p>
        <p><a href="../游戏/color-blast/dist/index.html">彩色子弹</a></p>
        <p><a href="../游戏/flipcard-memory-game/dist/index.html">记忆大师</a></p>
        <p><a href="../游戏/menja/dist/index.html">切箱子</a></p>
        <p><a href="../游戏/tower-blocks/dist/index.html">堆高高</a></p>
        <p><a href="../游戏/vanilla-js-snake/dist/index.html">贪吃蛇</a></p>
        <p><a href="../游戏/jspvz/index.html">植物大战僵尸</a></p>
        <p><a href="../游戏/magicube/index.html">魔方</a></p>
      </div>
    </div>
    <div class="game-list-container">
      <div class="right-content">
        <H2 class="sticky-header">Flash</H2>
      </div>
    </div>
  </div>
</body>
<script>
  function storage() {
    fetch('/gamelist')
      .then(response => response.json())
      .then(data => {
        //calStorage(data);
        populateGameList(data.games);
      })
      .then(() => { // 在音乐列表和存储信息处理完毕后，再次发起请求获取存储信息
        return fetch('/get_storage')
          .then(response => {
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            return response.json();
          })
          .then(data => {
            // 这里假设calStorage可以处理多次调用，或者有必要再次调用
            calStorage(data);
          })
          .catch(error => console.error('Error fetching storage info:', error));
      })
      .catch(error => console.error('Error:', error));
  }
  function calStorage(data) {
    const currentMemoryStr = bytesToSize(data.totalstorage);
    const totalMemoryStr = bytesToSize(data.totalstorage - data.storage);

    document.getElementById('currentMemory').innerText = totalMemoryStr;
    document.getElementById('totalMemory').innerText = " / " + currentMemoryStr;

    let percentageUsed = (data.storage / data.totalstorage) * 100;
    percentageUsed = Math.min(percentageUsed, 100);
    const progressBar = document.getElementById('memory-progress');
    progressBar.style.background = `linear-gradient(to right, #007bff 0%, #f3f3 ${percentageUsed}%)`;
  }
  function bytesToSize(bytes) {
    var sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
    if (bytes == 0) return '0 B';
    var i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));
    var size = bytes / Math.pow(1024, i);
    if (sizes[i] !== 'B') {
      size = size.toFixed(2);
    }
    return size + ' ' + sizes[i];
  }
  function populateGameList(games) {
    const rightContent = document.querySelector('.right-content');
    games.forEach(game => {
      const listItem = document.createElement('p');
      const linkWrapper = document.createElement('div'); // 创建一个包装div以保持结构
      const link = document.createElement('a');
      const fileSizeSpan = document.createElement('span');

      link.href = game.gamepath;
      link.textContent = game.gamepath.split('/').pop().replace('.swf', ''); // 游戏名

      fileSizeSpan.textContent = ` (${bytesToSize(game.filesize)})`; // 文件大小，并带有前后空格以保持间隔
      fileSizeSpan.classList.add('game-size');

      // 确保文件大小span在a标签内
      link.appendChild(fileSizeSpan);
      linkWrapper.appendChild(link); // 使用包装div来维持结构，如果需要的话
      listItem.appendChild(linkWrapper);

      rightContent.appendChild(listItem);
    });
  }
  window.onload = storage;
</script>

</html>