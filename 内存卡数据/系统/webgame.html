<!DOCTYPE HTML>
<html>
<style>
        .sticky-header {
                margin-left: 40px;
        }
</style>

<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <link rel="stylesheet" href="./CSS/sptx.css">
        <title>HaOs游戏库</title>
</head>
<section class="main">
        <H2 class="sticky-header">HTML</H2>
        <div class="box">
                <div><a data-url="../游戏/nes模拟器/index.html" href="../游戏/nes模拟器/index.html">
                                <div class="item">
                                        <div class="logo">nes模拟器</div>
                                        <div class="desc">童年的味道，双人游戏居多</div>
                                </div>
                        </a>
                </div>
                <div><a data-url="../游戏/liferestart/public/index.html" href="../游戏/liferestart/public/index.html">
                                <div class="item">
                                        <div class="logo">人生重开模拟器</div>
                                        <div class="desc">这一生糟糕透了，快来体验不一样的人生吧</div>
                                </div>
                        </a>
                </div>
                <div><a data-url="../游戏/bullseye-game/dist/index.html" href="../游戏/bullseye-game/dist/index.html">
                                <div class="item">
                                        <div class="logo">射箭</div>
                                        <div class="desc">简单拉弓射箭</div>
                                </div>
                        </a>
                </div>
                <div><a data-url="../游戏/color-blast/dist/index.html" href="../游戏/color-blast/dist/index.html">
                                <div class="item">
                                        <div class="logo">彩色子弹</div>
                                        <div class="desc">躲避敌人子弹并且反击吧</div>
                                </div>
                        </a>
                </div>
                <div><a data-url="../游戏/flipcard-memory-game/dist/index.html"
                                href="../游戏/flipcard-memory-game/dist/index.html">
                                <div class="item">
                                        <div class="logo">记忆大师</div>
                                        <div class="desc">预防老年痴呆从我做起</div>
                                </div>
                        </a>
                </div>
                <div><a data-url="../游戏/menja/dist/index.html" href="../游戏/menja/dist/index.html">
                                <div class="item">
                                        <div class="logo">切箱子</div>
                                        <div class="desc">好像就是换皮切水果</div>
                                </div>
                        </a>
                </div>
                <div><a data-url="../游戏/tower-blocks/dist/index.html" href="../游戏/tower-blocks/dist/index.html">
                                <div class="item">
                                        <div class="logo">堆高高</div>
                                        <div class="desc">开始建房子了</div>
                                </div>
                        </a>
                </div>
                <div><a data-url="../游戏/vanilla-js-snake/dist/index.html" href="../游戏/vanilla-js-snake/dist/index.html">
                                <div class="item">
                                        <div class="logo">贪吃蛇</div>
                                        <div class="desc">这个贪吃蛇好像没那么好</div>
                                </div>
                        </a>
                </div>
                <div><a data-url="../游戏/magicube/index.html" href="../游戏/magicube/index.html">
                                <div class="item">
                                        <div class="logo">魔方</div>
                                        <div class="desc">制作精良，值得推荐</div>
                                </div>
                        </a>
                </div>
                <div><a data-url="" href="">
                                <div class="item">
                                        <div class="logo">预留</div>
                                        <div class="desc">这个不是游戏，单纯为了统一格式</div>
                                </div>
                        </a>
                </div>
                <div><a data-url="" href="">
                                <div class="item">
                                        <div class="logo">预留</div>
                                        <div class="desc">这个不是游戏，单纯为了统一格式</div>
                                </div>
                        </a>
                </div>
                <div><a data-url="" href="">
                                <div class="item">
                                        <div class="logo">预留</div>
                                        <div class="desc">这个不是游戏，单纯为了统一格式</div>
                                </div>
                        </a>
                </div>
        </div>
        <H2 class="sticky-header">FLASH</H2>
        <div class="box" id="flashGamesBox">
        </div>
</section>

</body>
<script>
        function storage() {
                fetch('/gamelist')
                        .then(response => response.json())
                        .then(data => {
                                populateGameList(data.games);
                        })
                        .catch(error => console.error('Error:', error));
        }
        function populateGameList(games) {
                const flashGamesBox = document.getElementById('flashGamesBox');

                games.forEach(game => {
                        const gameDiv = document.createElement('div');
                        const link = document.createElement('a');
                        const item = document.createElement('div');
                        const logo = document.createElement('div');
                        const desc = document.createElement('div');

                        link.href = game.gamepath;
                        link.dataset.url = game.gamepath;

                        item.classList.add("item");
                        logo.classList.add("logo");
                        desc.classList.add("desc");

                        logo.textContent = game.name || game.gamepath.split('/').pop().replace('.swf', '');
                        desc.textContent = `大小: ${bytesToSize(game.filesize)}`;

                        item.appendChild(logo);
                        item.appendChild(desc);
                        link.appendChild(item);
                        gameDiv.appendChild(link);
                        flashGamesBox.appendChild(gameDiv);
                });
        }
        function bytesToSize(bytes) {
                var sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
                if (bytes == 0) return '0 B';
                var i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));
                var size = bytes / Math.pow(1024, i);
                if (sizes[i] !== 'B') {
                        size = size.toFixed(2);
                }
                return size + ' ' + sizes[i];
        }
        window.onload = storage;
</script>

</html>