function debug(info){if(info==null||info.length==0)return;var o=document.getElementById("debugPanel");var txt0=o.value;var txt1=txt0+info+"\n";o.value=txt1;o.scrollTop=o.scrollHeight}(function($,undefined){$.jwe={initContainer:function(){$.jweGame._scoreArr=new Array(_UniTypeNumberMax);for(var i=0;i<$.jweGame._scoreArr.length;i++)$.jweGame._scoreArr[i]=0;if(_UniTypeNumber>_UniTypeNumberMax)_UniTypeNumber=_UniTypeNumberMax;$.jwe.createAppCode();var tb=$("#panelTb");var html="";for(var i=0;i<_rowNum;i++){html+="<tr>";for(var j=0;j<_colNum;j++){var id="td_"+i+"_"+j;html+="<td id='"+id+"'></td>"}html+="</tr>"}tb.append(html);html="";var scP=$("#scorePanel");for(var i=0;i<_UniTypeNumber;i++){var N=$.jweCore._ucArr[i];html+=$.jweCore.scoreUni(N)}scP.append(html);$.jweGame._gameTime=_fullGameTime;$.jweAnimate.animGameTimeBar($.jweGame._gameTime)},resizeContainer:function(){var tb=$("#panelTb");var wi=-1,hi=-1;var o=null;var WI=parseInt($(window).width());var HI=parseInt($(window).height());var minBD=Math.min(WI,HI);var tdHi=Math.round((minBD-25)/_rowNum);var tdWi=tdHi;var os=tb.find("td");os.each(function(){$(this).css({width:tdWi,height:tdHi})});var tbWi=parseInt(tb.css("width"));tb.css({left:WI-tbWi-50,top:10});wi=HI*550/720;$("#bg1").css({width:wi,height:HI});$("#bg2").css({width:WI,height:HI});o=$("#scorePanel");o.css({fontSize:tdHi*0.2});o.find(".uni").css({width:tdWi*0.5,height:tdHi*0.5});hi=parseInt($("#mmPanel .giMM:first").css("height"));if(!isNaN(hi)){$("#mmPanel .giMM").css({top:HI-hi})}var minB=Math.min(WI,HI);var fSz=minB/5;var fSz2=minB/15;var pTop=(HI-fSz)/3;var pTop2=(HI-fSz)/2;$(".warn1").css({paddingTop:pTop,fontSize:fSz});$(".warn2").css({top:pTop2,fontSize:fSz2});o=$("#timeBar");hi=parseInt(tb.css("height"));wi=tdWi/10;o.css({width:wi,height:hi-10,left:parseInt(tb.css("left"))+parseInt(tb.css("width"))+4,top:parseInt(tb.css("top"))+5});$("#endPanel").css({height:HI,fontSize:minBD/20})},clearContainer:function(){clearTimeout($.jweGame._itv_run);clearTimeout($.jweAnimate._itv_animate);$("#panelTb .uni").remove();document.getElementById("debugPanel").value="";$.jweGame._sumScore=0;$.jweCtrl._focuseUni=null;$("#cartoonPanel").hide(0);$("#gameTimeText").text(_fullGameTime)},newStuff:function(){var os=$("#panelTb td");os.each(function(){$.jweAnimate.createUni(this)})},KillUnits:function(os){if(os==null||os.length<=0)return null;var str="";for(var i=0;i<os.length;i++){var id=$(os[i]).parent()[0].id;str+=id;if(i<os.length-1)str+=",";$.jweAnimate.killUni(os[i])}var arr=str.split(",");return arr},findBelongColumn:function(idArr){var str="";for(var i=0;i<idArr.length;i++){var id=idArr[i];var ss=id.split("_");str+=ss[2];if(i<idArr.length-1)str+=","}var arr=str.split(",");var arr2=arr.unique4();return arr2},DropDownUnits:function(dropingColArr){try{if(dropingColArr==null||dropingColArr.length==0)return;var idsArr=new Array();for(var i=0;i<dropingColArr.length;i++){var c=dropingColArr[i];if(c=="")continue;var rNArr=new Array();var deepEm=-1;var emptyNum=0;for(var r=_rowNum-1;r>=0;r--){var id="td_"+r+"_"+c;var TD=$("#"+id);var o=TD.find(".uni");if(o.length>0){if(deepEm>=0)rNArr.push(r)}else{if(deepEm<0)deepEm=r;emptyNum++}}var rowN=deepEm;for(var k=0;k<rNArr.length;k++){var id="td_"+rNArr[k]+"_"+c;var id2="td_"+rowN+"_"+c;var TD=$("#"+id);var TD2=$("#"+id2);$.jweCore.copyUniFromTD(TD,TD2);rowN--;idsArr.push(id2)}for(var k=0;k<emptyNum;k++){var id="td_"+k+"_"+c;var TD=$("#"+id);$.jweCore.newSkyUniAtTD(TD,emptyNum);idsArr.push(id)}}idsArr.sort();$.jweAnimate.moveToZeroPlace(idsArr,$.jweAnimate._unitDownTime)}catch(ex){alert("jwe - DropDown err:\n"+ex.message)}},SortScorePanle:function(){try{var len=$.jweCore._ucArr.length;var scArr=new Array(len);for(var i=0;i<len;i++){scArr[i]=$.jweGame._scoreArr[$.jweCore._ucArr[i]]}sortArr2(scArr,$.jweCore._ucArr);var base=$("#scorePanel #cLine");var allZero=true;for(var i=len-1;i>=0;i--){var n=$.jweCore._ucArr[i];var o=$("#sDiv"+n);o.insertAfter(base);var sb=o.find(".scBar:first");var v=parseInt(scArr[i]);allZero=allZero&&(v==0);sb.text(v);$.jweAnimate.chkUniBtnClass(o.find(".uni:first"),v)}var newT=$.jweCore._ucArr[0];if($.jweGame._bestUType==null||$.jweGame._bestUType!=newT){$.jweGame._bestUType=newT;if(allZero==false){$.jweAnimate.showBg($.jweGame._bestUType)}}}catch(ex){alert("SortScorePanle err:\n"+ex.message)}},GameDataStatisic:function(msg){try{var html="",n=-1,info="";var sP=$("#statPanel");html="<table id='table1' align='center'><tr>";html+="</tr></table>";sP.append(html);for(var i=0;i<$.jweCore._ucArr.length;i++){n=$.jweCore._ucArr[i];var mmID="uGi"+n;info="消除:"+$.jweGame._scoreArr[n];var inC=$.jweCore.aStatGirlImg(n);html=$.jweCore.aStatUni(n,inC,info);sP.find("#table1 TR:first").append(html);var tmpO=sP.find("#table1 .giMM:last");$.jweCore.LoadACharacter(tmpO,n,i+1)}var eP=$("#endPanel");var o2=eP.find("#finUni");html=msg;if($.jweGame._sumScore>0){n=$.jweGame._bestUType;html+="<a id='aWinner'>"+$.jweCore.uniCode(n)+"</a>";html+=$.jweGame._girlSpeechArr[n]}else{html+="<a>"+$.jweCore.uniCode_blank()+"</a>";html+="<p>啊...竟然一个都没有?<br>阁下的运气真是...</p>"}o2.html(html)}catch(ex){alert(ex)}},LoadGamingGirls:function(){for(var i=0;i<$.jweCore._ucArr.length;i++){var n=$.jweCore._ucArr[i];if(isNaN(n)==false)$.jweAnimate.aNewUGirl(n,i+1)}$.jweAnimate.moveAllGamingGirls()},createAppCode:function(){while($.jweCore._ucArr.length<_UniTypeNumber){var n=Math.floor(Math.random()*(_UniTypeNumberMax));var isNew=true;for(var k in $.jweCore._ucArr){if($.jweCore._ucArr[k]==n){isNew=false;break}}if(isNew)$.jweCore._ucArr.push(n)}}}}(jQuery));